/work/dlclarge2/masoodw-spino100/miniconda3/envs/spino/lib/python3.8/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/work/dlclarge2/masoodw-spino100/dl-lab/SPINO/panoptic_label_generator/external/ms_deformable_attention/functions/deform_attn_func.py:21: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  @custom_fwd(cast_inputs=torch.float32)
/work/dlclarge2/masoodw-spino100/dl-lab/SPINO/panoptic_label_generator/external/ms_deformable_attention/functions/deform_attn_func.py:38: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  def backward(ctx, grad_output):
xFormers not available
xFormers not available
[rank: 0] Seed set to 0
/work/dlclarge2/masoodw-spino100/miniconda3/envs/spino/lib/python3.8/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python panoptic_label_generator/semantic_fine_tuning.py fit ...
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

[ENCODER] Using encoder: ViTCoMeR
Collect Cityscapes frames [train]:   0%|          | 0/2975 [00:00<?, ?it/s]Collect Cityscapes frames [train]:   7%|▋         | 218/2975 [00:00<00:01, 2175.79it/s]Collect Cityscapes frames [train]:  15%|█▌        | 454/2975 [00:00<00:01, 2279.31it/s]Collect Cityscapes frames [train]:  23%|██▎       | 682/2975 [00:00<00:01, 2278.08it/s]Collect Cityscapes frames [train]:  31%|███       | 920/2975 [00:00<00:00, 2317.48it/s]Collect Cityscapes frames [train]:  39%|███▉      | 1156/2975 [00:00<00:00, 2330.78it/s]Collect Cityscapes frames [train]:  47%|████▋     | 1390/2975 [00:00<00:00, 2323.68it/s]Collect Cityscapes frames [train]:  55%|█████▌    | 1641/2975 [00:00<00:00, 2382.75it/s]Collect Cityscapes frames [train]:  63%|██████▎   | 1880/2975 [00:00<00:00, 2376.52it/s]Collect Cityscapes frames [train]:  71%|███████   | 2118/2975 [00:00<00:00, 2363.39it/s]Collect Cityscapes frames [train]:  79%|███████▉  | 2355/2975 [00:01<00:00, 2329.40it/s]Collect Cityscapes frames [train]:  87%|████████▋ | 2589/2975 [00:01<00:00, 2311.62it/s]Collect Cityscapes frames [train]:  95%|█████████▍| 2821/2975 [00:01<00:00, 2306.93it/s]Collect Cityscapes frames [train]: 100%|██████████| 2975/2975 [00:01<00:00, 2325.99it/s]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type     | Params | Mode 
---------------------------------------------
0 | encoder | ViTCoMer | 126 M  | train
1 | head    | Conv2d   | 58.4 K | train
---------------------------------------------
40.1 M    Trainable params
86.6 M    Non-trainable params
126 M     Total params
506.553   Total estimated model params size (MB)
402       Modules in train mode
0         Modules in eval mode
/work/dlclarge2/masoodw-spino100/miniconda3/envs/spino/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:424: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=7` in the `DataLoader` to improve performance.
Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/10 [00:00<?, ?it/s] Epoch 0:  10%|█         | 1/10 [00:02<00:20,  0.43it/s]Epoch 0:  10%|█         | 1/10 [00:02<00:20,  0.43it/s]Epoch 0:  20%|██        | 2/10 [00:02<00:11,  0.71it/s]Epoch 0:  20%|██        | 2/10 [00:02<00:11,  0.70it/s]Epoch 0:  30%|███       | 3/10 [00:03<00:07,  0.89it/s]Epoch 0:  30%|███       | 3/10 [00:03<00:07,  0.89it/s]Epoch 0:  40%|████      | 4/10 [00:03<00:05,  1.03it/s]Epoch 0:  40%|████      | 4/10 [00:03<00:05,  1.03it/s]Epoch 0:  50%|█████     | 5/10 [00:04<00:04,  1.14it/s]Epoch 0:  50%|█████     | 5/10 [00:04<00:04,  1.14it/s]Epoch 0:  60%|██████    | 6/10 [00:04<00:03,  1.22it/s]Epoch 0:  60%|██████    | 6/10 [00:04<00:03,  1.22it/s]Epoch 0:  70%|███████   | 7/10 [00:05<00:02,  1.29it/s]Epoch 0:  70%|███████   | 7/10 [00:05<00:02,  1.29it/s]Epoch 0:  80%|████████  | 8/10 [00:05<00:01,  1.34it/s]Epoch 0:  80%|████████  | 8/10 [00:05<00:01,  1.34it/s]Epoch 0:  90%|█████████ | 9/10 [00:06<00:00,  1.39it/s]Epoch 0:  90%|█████████ | 9/10 [00:06<00:00,  1.39it/s]Epoch 0: 100%|██████████| 10/10 [00:07<00:00,  1.43it/s]Epoch 0: 100%|██████████| 10/10 [00:07<00:00,  1.42it/s]Epoch 0: 100%|██████████| 10/10 [00:07<00:00,  1.42it/s]Epoch 0:   0%|          | 0/10 [00:00<?, ?it/s]         Epoch 1:   0%|          | 0/10 [00:00<?, ?it/s]/work/dlclarge2/masoodw-spino100/miniconda3/envs/spino/lib/python3.8/site-packages/torch/functional.py:513: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3609.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
Epoch 1:  10%|█         | 1/10 [00:01<00:12,  0.74it/s]Epoch 1:  10%|█         | 1/10 [00:01<00:12,  0.74it/s]Epoch 1:  20%|██        | 2/10 [00:01<00:07,  1.06it/s]Epoch 1:  20%|██        | 2/10 [00:01<00:07,  1.06it/s]Epoch 1:  30%|███       | 3/10 [00:02<00:05,  1.25it/s]Epoch 1:  30%|███       | 3/10 [00:02<00:05,  1.25it/s]Epoch 1:  40%|████      | 4/10 [00:02<00:04,  1.36it/s]Epoch 1:  40%|████      | 4/10 [00:02<00:04,  1.36it/s]Epoch 1:  50%|█████     | 5/10 [00:03<00:03,  1.45it/s]Epoch 1:  50%|█████     | 5/10 [00:03<00:03,  1.45it/s]Epoch 1:  60%|██████    | 6/10 [00:03<00:02,  1.50it/s]Epoch 1:  60%|██████    | 6/10 [00:03<00:02,  1.50it/s]Epoch 1:  70%|███████   | 7/10 [00:04<00:01,  1.55it/s]Epoch 1:  70%|███████   | 7/10 [00:04<00:01,  1.55it/s]Epoch 1:  80%|████████  | 8/10 [00:05<00:01,  1.59it/s]Epoch 1:  80%|████████  | 8/10 [00:05<00:01,  1.59it/s]Epoch 1:  90%|█████████ | 9/10 [00:05<00:00,  1.62it/s]Epoch 1:  90%|█████████ | 9/10 [00:05<00:00,  1.61it/s]Epoch 1: 100%|██████████| 10/10 [00:06<00:00,  1.64it/s]Epoch 1: 100%|██████████| 10/10 [00:06<00:00,  1.64it/s]Epoch 1: 100%|██████████| 10/10 [00:06<00:00,  1.64it/s]Epoch 1:   0%|          | 0/10 [00:00<?, ?it/s]         Epoch 2:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 2:  10%|█         | 1/10 [00:01<00:12,  0.74it/s]Epoch 2:  10%|█         | 1/10 [00:01<00:12,  0.73it/s]Epoch 2:  20%|██        | 2/10 [00:01<00:07,  1.06it/s]Epoch 2:  20%|██        | 2/10 [00:01<00:07,  1.06it/s]Epoch 2:  30%|███       | 3/10 [00:02<00:05,  1.24it/s]Epoch 2:  30%|███       | 3/10 [00:02<00:05,  1.24it/s]Epoch 2:  40%|████      | 4/10 [00:02<00:04,  1.36it/s]Epoch 2:  40%|████      | 4/10 [00:02<00:04,  1.36it/s]Epoch 2:  50%|█████     | 5/10 [00:03<00:03,  1.44it/s]Epoch 2:  50%|█████     | 5/10 [00:03<00:03,  1.44it/s]Epoch 2:  60%|██████    | 6/10 [00:03<00:02,  1.50it/s]Epoch 2:  60%|██████    | 6/10 [00:03<00:02,  1.50it/s]Epoch 2:  70%|███████   | 7/10 [00:04<00:01,  1.55it/s]Epoch 2:  70%|███████   | 7/10 [00:04<00:01,  1.55it/s]Epoch 2:  80%|████████  | 8/10 [00:05<00:01,  1.58it/s]Epoch 2:  80%|████████  | 8/10 [00:05<00:01,  1.58it/s]Epoch 2:  90%|█████████ | 9/10 [00:05<00:00,  1.61it/s]Epoch 2:  90%|█████████ | 9/10 [00:05<00:00,  1.61it/s]Epoch 2: 100%|██████████| 10/10 [00:06<00:00,  1.63it/s]Epoch 2: 100%|██████████| 10/10 [00:06<00:00,  1.63it/s]Epoch 2: 100%|██████████| 10/10 [00:06<00:00,  1.63it/s]Epoch 2:   0%|          | 0/10 [00:00<?, ?it/s]         Epoch 3:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 3:  10%|█         | 1/10 [00:01<00:12,  0.75it/s]Epoch 3:  10%|█         | 1/10 [00:01<00:12,  0.75it/s]Epoch 3:  20%|██        | 2/10 [00:01<00:07,  1.07it/s]Epoch 3:  20%|██        | 2/10 [00:01<00:07,  1.07it/s]Epoch 3:  30%|███       | 3/10 [00:02<00:05,  1.25it/s]Epoch 3:  30%|███       | 3/10 [00:02<00:05,  1.25it/s]Epoch 3:  40%|████      | 4/10 [00:02<00:04,  1.36it/s]Epoch 3:  40%|████      | 4/10 [00:02<00:04,  1.36it/s]Epoch 3:  50%|█████     | 5/10 [00:03<00:03,  1.44it/s]Epoch 3:  50%|█████     | 5/10 [00:03<00:03,  1.44it/s]Epoch 3:  60%|██████    | 6/10 [00:04<00:02,  1.50it/s]Epoch 3:  60%|██████    | 6/10 [00:04<00:02,  1.50it/s]Epoch 3:  70%|███████   | 7/10 [00:04<00:01,  1.54it/s]Epoch 3:  70%|███████   | 7/10 [00:04<00:01,  1.54it/s]Epoch 3:  80%|████████  | 8/10 [00:05<00:01,  1.56it/s]Epoch 3:  80%|████████  | 8/10 [00:05<00:01,  1.56it/s]Epoch 3:  90%|█████████ | 9/10 [00:05<00:00,  1.59it/s]Epoch 3:  90%|█████████ | 9/10 [00:05<00:00,  1.59it/s]Epoch 3: 100%|██████████| 10/10 [00:06<00:00,  1.60it/s]Epoch 3: 100%|██████████| 10/10 [00:06<00:00,  1.60it/s]Epoch 3: 100%|██████████| 10/10 [00:06<00:00,  1.60it/s]Epoch 3:   0%|          | 0/10 [00:00<?, ?it/s]         Epoch 4:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 4:  10%|█         | 1/10 [00:01<00:12,  0.73it/s]Epoch 4:  10%|█         | 1/10 [00:01<00:12,  0.73it/s]Epoch 4:  20%|██        | 2/10 [00:01<00:07,  1.05it/s]Epoch 4:  20%|██        | 2/10 [00:01<00:07,  1.05it/s]Epoch 4:  30%|███       | 3/10 [00:02<00:05,  1.23it/s]Epoch 4:  30%|███       | 3/10 [00:02<00:05,  1.23it/s]Epoch 4:  40%|████      | 4/10 [00:03<00:04,  1.33it/s]Epoch 4:  40%|████      | 4/10 [00:03<00:04,  1.33it/s]Epoch 4:  50%|█████     | 5/10 [00:03<00:03,  1.39it/s]Epoch 4:  50%|█████     | 5/10 [00:03<00:03,  1.39it/s]Epoch 4:  60%|██████    | 6/10 [00:04<00:02,  1.43it/s]Epoch 4:  60%|██████    | 6/10 [00:04<00:02,  1.43it/s]Epoch 4:  70%|███████   | 7/10 [00:04<00:02,  1.47it/s]Epoch 4:  70%|███████   | 7/10 [00:04<00:02,  1.47it/s]Epoch 4:  80%|████████  | 8/10 [00:05<00:01,  1.49it/s]Epoch 4:  80%|████████  | 8/10 [00:05<00:01,  1.49it/s]
Detected KeyboardInterrupt, attempting graceful shutdown ...
